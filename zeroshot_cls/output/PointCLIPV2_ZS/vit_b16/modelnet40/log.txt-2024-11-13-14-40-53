Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.4 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.1) 9.4.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.31

Python version: 3.10.10 (main, Mar 21 2023, 18:45:11) [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-5.13.0-30-generic-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA GeForce RTX 2080 Ti
Nvidia driver version: 515.105.01
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] numpy==1.23.5
[pip3] pytorch3d==0.7.3
[pip3] torch==1.13.1
[pip3] torch-cluster==1.6.1
[pip3] torch-geometric==2.3.1
[pip3] torch-scatter==2.1.2
[pip3] torchaudio==0.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0           py310h7f8727e_0  
[conda] mkl_fft                   1.3.1           py310hd6ae3a3_0  
[conda] mkl_random                1.2.2           py310h00e6091_0  
[conda] numpy                     1.23.5          py310hd5efca6_0  
[conda] numpy-base                1.23.5          py310h8e6c178_0  
[conda] pytorch                   1.13.1          py3.10_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_3    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] pytorch3d                 0.7.3           py310_cu117_pyt1131    pytorch3d
[conda] torch-cluster             1.6.1                    pypi_0    pypi
[conda] torch-geometric           2.3.1                    pypi_0    pypi
[conda] torch-scatter             2.1.2                    pypi_0    pypi
[conda] torchaudio                0.13.1              py310_cu117    pytorch
[conda] torchvision               0.14.1              py310_cu117    pytorch
        Pillow (9.4.0)

Loading trainer: PointCLIPV2_ZS
Loading dataset: ModelNet40
***** Dataset statistics *****
  Dataset: ModelNet40
  # classes: 40
  # train_x: 9,840
  # val: 2,468
  # test: 2,468
Loading CLIP (backbone: ViT-B/16)
Loading evaluator: Classification
Do evaluation on test set
=> result
* total: 2,468
* correct: 1,573.0
* accuracy: 63.74%
* error: 36.26%
Save feature: ============================
Save labels: =============================
Total time: 37.10272216796875

***** Searching for prompts *****
Encoding prompt...
End encoding prompt.
=> Before search, zero-shot accuracy: 63.90
During search:
New best accuracy: 64.06, i-th class: 4, j-th sentence: 522
New best accuracy: 64.10, i-th class: 5, j-th sentence: 51
New best accuracy: 64.14, i-th class: 6, j-th sentence: 467
New best accuracy: 64.18, i-th class: 8, j-th sentence: 262
New best accuracy: 64.22, i-th class: 13, j-th sentence: 1036
New best accuracy: 64.26, i-th class: 15, j-th sentence: 504
New best accuracy: 64.30, i-th class: 35, j-th sentence: 590
New best accuracy: 64.38, i-th class: 36, j-th sentence: 3
New best accuracy: 64.42, i-th class: 38, j-th sentence: 597
New best accuracy: 64.47, i-th class: 11, j-th sentence: 7

The best prompt is: 
['A three-dimensional model of an airplane composed of gray, fuzzy balls.', 'A lumpy 3D model of a slanted bathtub made of dull gray balls.', 'A bed is typically represented by a rectangular shape on a grayscale map.', 'A bench can be identified from a grayscale map by its shape.', 'An unclear depth map in shades of gray of a bookshelf model at a slanted angle.', 'This depth map is of a bottle that is partially filled with water.', 'A 3D model of an inclined bowl composed of gray obscure balls is a rough model of a bowl that is composed of gray, unclear balls.', 'This is a depth map of a car 3D model, generated by depth sensing cameras.', 'The chair would be a dark object on the grayscale map.', 'A 3D model of a cone would look like a cone shape.', 'An obscure cup was found at the depth map.', 'This is aDepth map of a 3D model of a curtain.', 'An obscure depth map of a desk would likely show a few objects on the desk in great detail, while the rest of the desk would be less detailed and more blurry.', 'This heightmap shows a door that is simple and obscure.', 'A white heightmap in a black background of a dresser would look like a white rectangle in the center of the dresser with a black border.', 'The sentence is describing an image of a flower pot that is gray and white in color, and is tilted at an angle.', 'A glass box will appear as a bright white region in a depth map.', 'I am looking at a 3D model of a guitar.', '3D render of a keyboard with heightmap.', 'There is an obscure depth map of a lamp.', 'The depth map of a laptop 3D model is a top-down view of the laptop, showing its various components in different colors.', 'The left or right view depth map of a white mantel would look like a white rectangle with some depth to it.', 'A grayscale image of a monitor.', 'A white, porous depth map of a night stand might look like a ghostly image of the furniture piece, with its contours and dimensions visible but slightly blurred.', 'A heightmap of a person, showing their height at different points along their body.', 'The piano would be the blackest object on the grayscale map.', 'This depth map is of a plant against a black background and is full of pores.', 'A typical radiolooks like a rectangular box with a handle on the top.', 'There is an obscure depth map of a range hood.', 'A depth map of a sink 3D model can be quite obscure, as the sink is often hidden behind other objects in a room.', 'This is a depth map of a 3D model of a sofa.', 'Thestairs3Dmodelhas a Depth Map that is quite Obscure .', 'A stool can vary in shape and size, but typically it is a small, round object that is used for sitting.', 'A 3D model of a table typically looks like a rectangular object with four legs.', 'A grayscale or white depth map of a tent 3D model would show the tent as a white object against a black background.', 'A grayscale or white depth map of a toilet 3D model would look like a black and white photo of a toilet, with the white areas representing the highest points, and the black areas representing the lowest points.', 'The image is a depth map of a 3D model of a TV stand.', 'A grayscale or white depth map of a vase 3D model would show the contours of the vase in shades of gray or white, with the darkest areas representing the deepest parts of the vase.', 'A grayscale or white depth map of a wardrobe 3D model would show the overall shape and form of the wardrobe, as well as the depth of each component.', 'A grayscale depth map of a 3D Xbox model would show a range of light to dark gray tones, with the darkest areas representing the closest parts of the model to the viewer, and the lightest areas representing the farthest parts of the model.']

After prompt search, zero-shot accuracy: 64.46515397082658
